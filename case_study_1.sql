CREATE DATABASE DEMO

USE DEMO

SELECT * FROM FACT

SELECT * FROM LOCATION

SELECT * FROM PRODUCT


1) How many states are there where products have been sold ?

--REPLACE DISPLAY NUMBER OF STATES PRESENT IN THE LOCATION TABLE


MAX , MIN, COUNT , AVG , SUM

SELECT COUNT(DISTINCT STATE) AS STATE FROM LOCATION

SELECT * FROM LOCATION

2) How many products are of regular type ?

SELECT COUNT( PRODUCT) AS PRODUCT_COUNT FROM PRODUCT WHERE TYPE='REGULAR'


3) How much spending has been done on marketing of product id 1

SELECT SUM(MARKETING) AS MARKETING FROM FACT WHERE PRODUCTID=1


4) What is the minimum sales of a product ?

SELECT MIN(SALES)AS MIN_SALES FROM FACT

SELECT * FROM PRODUCT

5) Display max Cost of Good Sold(COGS).SELECT MAX(COGS) AS COGS FROM FACTFACT->NUMERIC VALUE -> SALARYDIMENSION->TEXT ATTRIBUTE -> NAME , DESIGNATION6) Display the Details of the productid where product type is coffee

SELECT PRODUCTID FROM PRODUCT WHERE PRODUCT_TYPE='COFFEE'

SELECT * FROM PRODUCT

7) Display the details where total_expenses is greater than 40.

SELECT * FROM FACT WHERE TOTAL_EXPENSES > 40

8) What is the average sales in Area_Code 719 ?

SELECT AVG(SALES) AS AVG_SALES FROM FACT WHERE AREA_CODE =719


SELECT * FROM FACT

SELECT * FROM LOCATION

JOIN

--COMBINE ROWS FROM 2 OR MORE TABLE BASED UPON THE RELATED COLUMN BETWEEN THEM

4 TYPES 

INNER JOIN ->MATCHING RECORDS FROM BOTH THE TABLE >1 2 3
LEFT JOIN  ->DISPLAY ALL THE RECORDS FROM LEFT TABLE ALONG WITH ONLY MATCHING RECORD FROM RIGHT TABLE
RIGHT JOIN ->DISPLAY ALL THE RECORDS FROM RIGHT TABLE ALONG WITH ONLY MATCHING RECORD FROM LEFT TABLE
FULL OUTER JOIN  -> ALL THE RECORDS FROM BOTH THE TABLE


TABLE1      TABLE2
1			1
2			2
3           3
4           8
5           9

SYNTAX


SELECT * /COL_NAME.TABLE_NAME FROM TABLE1  [JOIN TYPE] TABLE2 
ON TABLE1_NAME.COL_NAME=TABLE2_NAME.COLNAME [JOIN TYPE] TABLE3
ON TABLE2_NAME.COL_NAME=TABLE3_NAME.COLNAME


9) Find out the total profit generated by Colorado state.

SELECT SUM(PROFIT) AS TOTAL_PROFIT FROM FACT INNER JOIN LOCATION

ON FACT.AREA_CODE=LOCATION.AREA_CODE WHERE STATE='COLORADO'

10) Display the average inventory for each product id.SELECT PRODUCTID,AVG(INVENTORY) AS AVG FROM FACT GROUP BY PRODUCTID ORDER BY PRODUCTIDSELECT * FROM FACT11) Display state in a sequential order in a location table.

SELECT DISTINCT STATE FROM LOCATION ORDER BY  STATE 

select * from location order by state Desc



12) Display the average budget margin of the store where average budget margin should be
greater than 100.


SELECT PRODUCTID, AVG(BUDGET_MARGIN) AS AVG_BUDGET FROM FACT GROUP BY PRODUCTID HAVING AVG(BUDGET_MARGIN)>100


13) What is the total sales done on date 2010-01-01


SELECT SUM(SALES) AS TOTAL_SALES FROM FACT WHERE DATE='2010-01-01 '


14) Display the average total expense of each product id on individual date

SELECT PRODUCTID, DATE, AVG(TOTAL_EXPENSES) AS AVG FROM FACT GROUP BY PRODUCTID ,DATE

ORDER BY PRODUCTID


15) Display the table with the following attributes such as
Date, productid, product_type, product, Sales, profit, state, area_codeSELECT DATE, FACT.PRODUCTID ,PRODUCT_TYPE , PRODUCT , SALES , PROFIT , STATE , FACT.AREA_CODEFROM FACT INNER JOIN LOCATION ON  FACT.AREA_CODE=LOCATION.AREA_CODE INNER JOIN PRODUCTON FACT.PRODUCTID=PRODUCT.PRODUCTID16) Display the rank without any gap to show the Sales wise rank.


SELECT SALES,DENSE_RANK() OVER (ORDER BY SALES DESC)AS SALES_RANK FROM FACT
SELECT SALES,RANK() OVER (ORDER BY SALES ASC)AS SALES_RANK FROM FACT


17) Find the State wise Profit and Sales.

SELECT STATE, SUM(SALES) AS SALES , SUM(PROFIT) AS PROFIT FROM FACT INNER JOIN LOCATION ON
FACT.AREA_CODE=LOCATION.AREA_CODE GROUP BY STATE


18) Find the State wise Profit and Sales along with the Product Name.SELECT STATE, PRODUCT ,SUM(SALES) AS SALES , SUM(PROFIT) AS PROFIT FROM FACT INNER JOIN LOCATION ON
FACT.AREA_CODE=LOCATION.AREA_CODE INNER JOIN PRODUCT ON FACT.PRODUCTID=PRODUCT.PRODUCTID GROUP BY STATE ,PRODUCT